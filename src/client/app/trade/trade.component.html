<h2>Trade</h2>

<md-tab-group>
  <md-tab label="MY REQUESTS">
    <md-card
      *ngFor="let req of myRequests | async"
      [class.highlight]="highlight === req._id"
    >
      <a [routerLink]="['/book', req.book.info.volumeID]">
        <h3 md-card-title>{{req.book.info.title}}</h3>
        <h6 md-card-subtitle>{{req.book.info.subtitle}}</h6>
        <img md-card-image [src]="req.book.info.thumbnail" [alt]="req.book.info.title">
      </a>
      <dl>
        <dt>Comment</dt>
        <dd>{{req.comment}}</dd>
        <dt>Request Date</dt>
        <dd>{{req.requestDate}}</dd>
        <dt>Book Info</dt>
        <dt>Status</dt>
        <dd>
          <p *ngIf="req.isCompleted">Completed on {{req.completeDate}}</p>
          <p *ngIf="!req.isCompleted && req.isAccepted">Accepted</p>
          <p *ngIf="req.isRejected">Rejected</p>
          <p *ngIf="!req.isAccepted && !req.isRejected">Pending</p>
        </dd>
      </dl>

      <md-card-actions align="end">
        <button
          *ngIf="!req.isCompleted"
          md-button
          (click)="withdraw(req._id)">
        Withdraw</button>
        <button
          *ngIf="!req.isCompleted && req.isAccepted"
          md-button
          (click)="complete(req._id)"
        >Complete</button>
      </md-card-actions>
    </md-card>
  </md-tab>

  <md-tab label="THEIR REQUESTS">
    <md-card *ngFor="let req of theirRequests | async |
      tradeFilter: 'isRejected': false">
      <a [routerLink]="['/book', req.book.info.volumeID]">
        <h3 md-card-title>{{req.book.info.title}}</h3>
        <h6 md-card-subtitle>{{req.book.info.subtitle}}</h6>
        <img
          md-card-image
          [src]="req.book.info.thumbnail"
          [alt]="req.book.info.title"
        >
      </a>

      <ng-container md-card-content>
        <h4>Requester Info</h4>
        <dl>
          <dt>Comment</dt>
          <dd>{{req.comment}}</dd>
          <dt>Name</dt>
          <dd>{{req.requester.displayName || req.requester.name}}</dd>
          <dt>Email</dt>
          <dd>{{req.requester.email || '-'}}</dd>
          <dt>Location</dt>
          <dd>{{req.requester.location || '-'}}</dd>
          <dt>Last Login</dt>
          <dd>{{req.requester.lastLogin|date}}</dd>
          <dt>Request Date</dt>
          <dd>{{req.requestDate|date}}</dd>
        </dl>

        <p *ngIf="req.isCompleted">
          Completed on {{req.completeDate|date}}
        </p>
        <p *ngIf="req.isAccepted && !req.isCompleted">
          Accepted
        </p>
      </ng-container>
      <md-card-actions *ngIf="!req.isAccepted" align="end">
        <button md-button (click)="reject(req._id)">Reject</button>
        <button md-button (click)="accept(req._id)">Accept</button>
      </md-card-actions>
    </md-card>
  </md-tab>
</md-tab-group>

